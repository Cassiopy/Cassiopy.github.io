<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Fiesta de Navidad</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Montserrat:wght@300;400;500;600;700&family=Great+Vibes&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Decorative stars background -->
    <div class="stars-bg">
      <div class="star star-1"></div>
      <div class="star star-2"></div>
      <div class="star star-3"></div>
      <div class="star star-4"></div>
      <div class="star star-5"></div>
      <div class="star star-6"></div>
      <div class="star star-7"></div>
      <div class="star star-8"></div>
    </div>

    <!-- Music player -->
    <div class="music-player">
      <audio id="bg-music" loop>
        <source src="Dua Lipa - Levitating Featuring DaBaby (Official Music Video) - Dua Lipa.mp3" type="audio/mpeg">
        Tu navegador no soporta el elemento de audio.
      </audio>
      <button id="music-btn" class="music-btn" title="Reproducir mÃºsica">ğŸµ</button>
      <input id="volume-slider" class="volume-slider" type="range" min="0" max="100" value="30">
    </div>

    <main class="invite-container">
      <!-- Header with title -->
      <section class="header-section">
        <div class="decorative-top">
          <span class="sparkle">âœ¨</span>
          <span class="sparkle">âœ¨</span>
          <span class="sparkle">âœ¨</span>
        </div>
        
        <h1 class="title-main">Fiesta de</h1>
        <h1 class="title-main title-highlight">Navidad</h1>
        
        <p class="subtitle-text" id="greeting">Te invitamos a celebrar,</p>
        
        <div class="decorative-bottom">
          <span class="sparkle">âœ¨</span>
          <span class="sparkle">âœ¨</span>
          <span class="sparkle">âœ¨</span>
        </div>
      </section>

      <!-- Event details section -->
      <section class="details-section">
        <div class="detail-item">
          <span class="detail-icon">ğŸ“…</span>
          <div>
            <p class="detail-label">Fecha</p>
            <p class="detail-value">24 de Diciembre</p>
          </div>
        </div>

        <div class="detail-item">
          <span class="detail-icon">ğŸ•–</span>
          <div>
            <p class="detail-label">Hora</p>
            <p class="detail-value">18:00 hs</p>
          </div>
        </div>

        <div class="detail-item">
          <span class="detail-icon">ğŸ“</span>
          <div>
            <p class="detail-label">Lugar</p>
            <p class="detail-value">Los CastaÃ±os 279, Potrero de los Funes</p>
          </div>
        </div>
      </section>

      <!-- Map section -->
      <section class="map-section">
        <h2 class="section-title">Â¿CÃ³mo llegar?</h2>
        <div class="map-container">
          <a href="https://maps.app.goo.gl/q4VoT4RYrX7cpwts6" target="_blank" class="map-link">
            ğŸ“ Abrir en Google Maps
          </a>
          <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3353.2587463620753!2d-65.51622!3d-31.75856!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x940bc8f8c6c8c8c8%3A0x1234567890abcdef!2sLos%20Casta%C3%B1os%20279%2C%20Potrero%20de%20los%20Funes!5e0!3m2!1ses!2sar!4v1234567890123" 
            loading="lazy" 
            referrerpolicy="no-referrer-when-downgrade"
            class="map-iframe">
          </iframe>
        </div>
      </section>

      <!-- Photos section -->
      <section class="photos-section">
        <h2 class="section-title">ğŸ“¸ Compartir Fotos</h2>
        <p class="section-description">Guarda las fotos de la fiesta en nuestra carpeta compartida:</p>
        <a href="https://drive.google.com/drive/folders/10lwMtG7bVBI4earde9lrx412ZOsm0m42?usp=sharing" target="_blank" class="cta-button">
          ğŸ“ Abrir Google Drive
        </a>
      </section>

      <!-- QR & Share section -->
      <section class="share-section">
        <h2 class="section-title">Comparte la InvitaciÃ³n</h2>
        <p class="section-description">Personaliza el link con tu nombre:</p>
        
        <div class="share-tools">
          <input id="name-input" type="text" class="name-input" placeholder="Tu nombre" />
          <button id="make-link" class="action-btn">Generar Link</button>
          <button id="copy-link" class="action-btn">Copiar Link</button>
        </div>

        <div id="qrcode" class="qrcode-container"></div>
        <small class="qr-hint">Escanea para ver tu invitaciÃ³n personalizada</small>
      </section>

      <!-- Footer -->
      <footer class="footer-section">
        <p class="footer-text">Â¡Te esperamos para un aÃ±o mÃ¡s!</p>
        <p class="footer-subtitle">Una noche llena de magia y alegrÃ­a ğŸ„</p>
      </footer>
    </main>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <script>
      // Personalization: read ?to=Name
      function getParam(name) {
        const url = new URL(window.location.href);
        return url.searchParams.get(name);
      }

      const toName = getParam('to');
      const greeting = document.getElementById('greeting');
      if (toName) {
        greeting.textContent = `Querido/a ${decodeURIComponent(toName)}, te invitamos a celebrar,`;
      }

      // Music player
      const bgMusic = document.getElementById('bg-music');
      const musicBtn = document.getElementById('music-btn');
      const volumeSlider = document.getElementById('volume-slider');

      musicBtn.addEventListener('click', () => {
        if (bgMusic.paused) {
          bgMusic.play().catch(err => console.log('Autoplay blocked:', err));
          musicBtn.textContent = 'â¸ï¸';
        } else {
          bgMusic.pause();
          musicBtn.textContent = 'ğŸµ';
        }
      });

      volumeSlider.addEventListener('input', () => {
        bgMusic.volume = volumeSlider.value / 100;
      });

      bgMusic.volume = 0.3;

      // QR & link tools
      const nameInput = document.getElementById('name-input');
      const makeLinkBtn = document.getElementById('make-link');
      const copyLinkBtn = document.getElementById('copy-link');
      const qrcodeWrap = document.getElementById('qrcode');
      let qr = null;

      function currentBase() {
        return window.location.origin + window.location.pathname;
      }

      function makeLinkFor(name) {
        const url = new URL(currentBase());
        if (name) url.searchParams.set('to', name);
        return url.toString();
      }

      makeLinkBtn.addEventListener('click', () => {
        const name = nameInput.value.trim();
        if (!name) {
          alert('Por favor, ingresa tu nombre');
          return;
        }
        const link = makeLinkFor(name);
        qrcodeWrap.innerHTML = '';
        qr = new QRCode(qrcodeWrap, { text: link, width: 150, height: 150 });
      });

      copyLinkBtn.addEventListener('click', async () => {
        const name = nameInput.value.trim();
        if (!name) {
          alert('Por favor, ingresa tu nombre');
          return;
        }
        const link = makeLinkFor(name);
        try {
          await navigator.clipboard.writeText(link);
          copyLinkBtn.textContent = 'âœ“ Copiado!';
          setTimeout(() => (copyLinkBtn.textContent = 'Copiar Link'), 2000);
        } catch (e) {
          alert('No se pudo copiar. Link: ' + link);
        }
      });
    </script>
  </body>
</html>
